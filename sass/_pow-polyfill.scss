//
// By drtimofey, script based on script by davidkpiano, see these links:
// https://github.com/thoughtbot/bitters/issues/167
// https://github.com/thoughtbot/bourbon/issues/717
// https://gist.github.com/davidkpiano/ad6e6771df050ff3727f
//

@function math-pow-polyfill($number, $exp) {
  @if (round($exp) != $exp) {
    @return math-exp($exp * math-ln($number));
  }

  // Traditional method for integers
  @if $exp == 0 {
    @return 1;
  }
  @else if $exp < 0 {
    @return 1 / math-pow-polyfill($number, -$exp);
  }
  @else {
    $e: floor($exp / 2);
    $pow: math-pow-polyfill($number, $e);
    @if $e * 2 == $exp {
        @return $pow * $pow;
    } @else {
        @return $pow * $pow * $number;
    }
  }
}

@function math-exp($value) {
  $item: 1;
  $result: 1;

  @for $index from 1 to 100 {
    $item: $item * $value / $index;
    $result: $result + $item;
  }

  @return $result;
}

@function math-ln($value) {
  $ten-exp: 1;
  $ln-ten: 2.30258509;

  @while ($value > math-pow-polyfill(10, $ten-exp)) {
    $ten-exp: $ten-exp + 1;
  }

  $value: $value / math-pow-polyfill(10, $ten-exp);

  $item: -1;
  $result: 0;

  @for $index from 1 to 100 {
    $item: $item * (1 - $value);
    $result: $result + $item / $index;
  }

  @return $result + $ten-exp * $ln-ten;
}
